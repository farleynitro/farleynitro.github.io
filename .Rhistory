var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P21B))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P21B" ,x = "Zonas de Chile", y = "P21B") +
theme_minimal(base_family = "Roboto Condensed")
#frq(df_lapop_chile, eff1)
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean[var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean$P21B  > 0, ]
length(which(var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean$P21B==0))
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P21C))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P21C" ,x = "Zonas de Chile", y = "P21C") +
theme_minimal(base_family = "Roboto Condensed")
#frq(df_lapop_chile, eff1)
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean[var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean$P21C  > 0, ]
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P21D))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P21D" ,x = "Zonas de Chile", y = "P21D") +
theme_minimal(base_family = "Roboto Condensed")
#frq(df_lapop_chile, eff1)
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean[var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean$P21C  > 0, ]
var_dep_total_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean
var_dep_total_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean
#with p21_promedio and not its 3 subquestions
var_dep_total_clean_reduced <- var_dep_total_clean %>% select(dplyr::select(ZONAS,P1_MAmb, P2_COD, P3F, P4, P17_COD, P19_1,P19_2,P19_5,P19_6,P19_7,P19_8, P19_suma, P20, P21_promedio, P30)
var_dep_total_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean
#with p21_promedio and not its 3 subquestions
var_dep_total_clean_reduced <- var_dep_total_clean %>% dplyr::select(ZONAS,P1_MAmb, P2_COD, P3F, P4, P17_COD, P19_1,P19_2,P19_5,P19_6,P19_7,P19_8, P19_suma, P20, P21_promedio, P30)
pacman::p_load(tidyverse, haven, GGally, factoextra, FactoMineR)
var_dep_total_clean <- do.call(data.frame, var_dep_total_clean)
var_dep_total_clean_reduced <- do.call(data.frame, var_dep_total_clean_reduced)
str(var_dep_total_clean)
var_dep_total_clean_reduced[] <- lapply(var_dep_total_clean_reduced, function(x) {
if(is.factor(x)) as.numeric(as.character(x)) else x
})
write_sav(var_dep_total_clean_reduced, "var_dependientes_total_clean_reduced.sav")
cor(na.omit(var_dep_total_clean_reduced)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_total_clean_reduced, label = T) #NA se omiten automáticamente
var_dep_total_clean_reduced[] <- lapply(var_dep_total_clean_reduced, function(x) {
if(is.factor(x)) as.numeric(as.character(x)) else x
})
write_sav(var_dep_total_clean_reduced, "var_dependientes_total_clean_reduced.sav")
write_sav(var_dep_total_clean_unreduced, "var_dependientes_total_clean_unreduced.sav")
var_dep_total_clean_reduced[] <- lapply(var_dep_total_clean_reduced, function(x) {
if(is.factor(x)) as.numeric(as.character(x)) else x
})
write_sav(var_dep_total_clean_reduced, "var_dependientes_total_clean_reduced.sav")
write_sav(var_dep_total_clean, "var_dependientes_total_clean_unreduced.sav")
cor(na.omit(var_dep_total_clean_reduced)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_total_clean_reduced, label = T) #NA se omiten automáticamente
cor(na.omit(var_dep_total_clean)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_total_clean, label = T) #NA se omiten automáticamente
var_dep_total_clean_remove <- names(var_dep_total_clean_reduced) %in% c("ZONAS","P30", "P19_suma", "P21_promedio", "P4", "P20", "P17_COD")
var_dep_high_corr  <- var_dep_total_clean_reduced[!var_dep_total_clean_remove]
pca_1 <- PCA(var_dep_high_corr, graph = T) #Sin gráfico = F
var_dep_total_clean_reduced[] <- lapply(var_dep_total_clean_reduced, function(x) {
if(is.factor(x)) as.numeric(as.character(x)) else x
})
write_sav(var_dep_total_clean_reduced, "var_dependientes_total_clean_reduced_final.sav")
write_sav(var_dep_total_clean, "var_dependientes_total_clean_unreduced_final.sav")
cor(na.omit(var_dep_total_clean_reduced)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_total_clean_reduced, label = T) #NA se omiten automáticamente
var_dep_total_clean_remove <- names(var_dep_total_clean_reduced) %in% c("ZONAS","P30", "P19_suma", "P21_promedio", "P4", "P20", "P17_COD")
var_dep_high_corr  <- var_dep_total_clean_reduced[!var_dep_total_clean_remove]
pca_1 <- PCA(var_dep_high_corr, graph = T) #Sin gráfico = F
get_eig(pca_1)
fviz_eig(pca_1, choice = "eigenvalue", addlabels = T)
fviz_contrib(pca_1, choice = "var", axes = 1)
fviz_contrib(pca_1, choice = "var", axes = 2)
fviz_contrib(pca_1, choice = "var", axes = 3)
fviz_contrib(pca_1, choice = "var", axes = 4)
fviz_contrib(pca_1, choice = "var", axes = 5)
fviz_pca(pca_1, axes = c(1, 2), label = "var")
fviz_pca(pca_1, axes = c(1, 3), label = "var")
fviz_pca(pca_1, axes = c(2, 3), label = "var")
head(pca_1$ind$coord,12) #para cada observación, tendremos un score por dimensión.
head(pca_1$var$coord,12) #para cada observación, tendremos un score por dimensión.
get_eig(pca_1)
library(tidyverse)
library(sjmisc)
library(haven)
library(kableExtra)
library(readxl)
library(skimr)
library(sjPlot)
library(naniar)
library(ggcorrplot)
library(mice) # Imputación de datos
install.packages("mice")
library(tidyverse)
library(sjmisc)
library(haven)
library(kableExtra)
library(readxl)
library(skimr)
library(sjPlot)
library(naniar)
library(ggcorrplot)
library(mice) # Imputación de datos
library(naniar)
library(plyr)
library(dplyr)
#Cronbach analysis
library(psych)
install.packages("VIM")
library(tidyverse)
library(sjmisc)
library(haven)
library(kableExtra)
library(readxl)
library(skimr)
library(sjPlot)
library(naniar)
library(ggcorrplot)
library(mice) # Imputación de datos
library(VIM) # Ver los datos perdidos de nuestra base de datos
library(naniar)
library(plyr)
library(dplyr)
#Cronbach analysis
library(psych)
md.pattern(var_dep_total_clean_reduced)
aggr_plot <- aggr(var_dep_total_clean_reduced)
# #RECODING the values
P1_clean <- var_dep %>%
dplyr::select(P1_MAmb) %>%
rec(rec= "1=5;2=4;3=3;4=2;5=1;8,9=0;else=copy",suffix="")
P19_8 <- var_dep %>%
dplyr::select(P19_8) %>%
rec(rec= "1=1;0=5;else=copy",suffix="")
#create subset of dependent variables
var_dep <- df_2018_final %>%
dplyr::select(ZONAS,P1_MAmb,P2_COD,P3A,P3B,P3C,P3D,P3E,P3F,P4,
P17_COD,P19_1,P19_2,P19_3,P19_4,P19_5,P19_6,
P19_7,P19_8, P19_10, P20,P21A,P21B,P21C,
P21D,P30)
#1 to 7
#no NA values
unique(var_dep$P1_MAmb)
unique(var_dep$P2_COD)
unique(var_dep$P3A)
unique(var_dep$P3B)
unique(var_dep$P3C)
unique(var_dep$P3D)
unique(var_dep$P3E)
unique(var_dep$P3F)
unique(var_dep$P4)
#17 to 19
#no NA
unique(var_dep$P17_COD)
#has NA
unique(var_dep$P19_1)
unique(var_dep$P19_2)
unique(var_dep$P19_3)
unique(var_dep$P19_4)
unique(var_dep$P19_5)
unique(var_dep$P19_6)
unique(var_dep$P19_7)
unique(var_dep$P19_8)
unique(var_dep$P19_10)
#cleaning NAs by putting the "." as NA
var_dep %>% replace_with_na(replace = list(P19_1 = ".", P19_2= ".",P19_3=".",P19_4=".",P19_5=".",
P19_6=".",P19_7=".",P19_8=".",P19_10="."))
#has NA
unique(var_dep$P20)
#has NA
unique(var_dep$P21A)
unique(var_dep$P21B)
unique(var_dep$P21C)
unique(var_dep$P21D)
#cleaning NAs by putting the "." as NA
var_dep %>% replace_with_na(replace = list(P21A = ".", P21B= ".",P21C=".",P21D="."))
#no NA
unique(var_dep$P30)
#after cleaning all the data, convert to numeric type
var_dep[] <- lapply(var_dep, function(x) as.numeric(as.character(x)))
#17 to 19
#no NA
unique(var_dep$P17_COD)
#has NA
unique(var_dep$P19_1)
unique(var_dep$P19_2)
unique(var_dep$P19_3)
unique(var_dep$P19_4)
unique(var_dep$P19_5)
unique(var_dep$P19_6)
unique(var_dep$P19_7)
unique(var_dep$P19_8)
unique(var_dep$P19_10)
#cleaning NAs by putting the "." as NA
var_dep %>% replace_with_na(replace = list(P19_1 = ".", P19_2= ".",P19_3=".",P19_4=".",P19_5=".",
P19_6=".",P19_7=".",P19_8=".",P19_10="."))
#has NA
unique(var_dep$P20)
#has NA
unique(var_dep$P21A)
unique(var_dep$P21B)
unique(var_dep$P21C)
unique(var_dep$P21D)
#cleaning NAs by putting the "." as NA
var_dep %>% replace_with_na(replace = list(P21A = ".", P21B= ".",P21C=".",P21D="."))
#no NA
unique(var_dep$P30)
#after cleaning all the data, convert to numeric type
var_dep[] <- lapply(var_dep, function(x) as.numeric(as.character(x)))
P21A_clean <- var_dep %>%
dplyr::select(P21A) %>%
rec(rec= "1=1;2=2;3=4;4=5;8,9=0;else=copy", suffix="")
P21B_clean <- var_dep %>%
dplyr::select(P21B) %>%
rec(rec= "1=1;2=2;3=4;4=5;8,9=0;else=copy",suffix="")
P21C_clean <- var_dep %>%
dplyr::select(P21C) %>%
rec(rec= "1=1;2=2;3=4;4=5;8,9=0;else=copy",suffix="")
P21D_clean <- var_dep %>%
dplyr::select(P21D) %>%
rec(rec= "1=1;2=2;3=4;4=5;8,9=0;else=copy",suffix="")
var_dep$P21A <- P21A_clean
var_dep$P21B <- P21B_clean
var_dep$P21C <- P21C_clean
var_dep$P21D <- P21D_clean
var_dep$P21_promedio <- rowMeans(var_dep[23:25], na.rm=TRUE)
var_dep$P21_promedio <- scale(var_dep$P21_promedio, center = FALSE, scale = max(var_dep$P21_promedio, na.rm = TRUE)/5)
var_dep$P21_promedio <- round(var_dep$P21_promedio,0)
P19_8 <- var_dep %>%
dplyr::select(P19_8) %>%
rec(rec= "1=1;0=5;else=copy",suffix="")
P19_1 <- var_dep %>%
dplyr::select(P19_1) %>%
rec(rec= "1=5;0=1;else=copy",suffix="")
P19_2 <- var_dep %>%
dplyr::select(P19_2) %>%
rec(rec= "1=5;0=1;else=copy",suffix="")
P19_3 <- var_dep %>%
dplyr::select(P19_3) %>%
rec(rec= "1=5;0=1;else=copy",suffix="")
P19_4 <- var_dep %>%
dplyr::select(P19_4) %>%
rec(rec= "1=5;0=1;else=copy",suffix="")
P19_5 <- var_dep %>%
dplyr::select(P19_5) %>%
rec(rec= "1=5;0=1;else=copy",suffix="")
P19_6 <- var_dep %>%
dplyr::select(P19_6) %>%
rec(rec= "1=5;0=1;else=copy",suffix="")
P19_7 <- var_dep %>%
dplyr::select(P19_7) %>%
rec(rec= "1=5;0=1;else=copy",suffix="")
var_dep$P19_1 <- P19_1
var_dep$P19_2 <- P19_2
var_dep$P19_3 <- P19_4
var_dep$P19_4 <- P19_4
var_dep$P19_5 <- P19_5
var_dep$P19_6 <- P19_6
var_dep$P19_7 <- P19_7
var_dep$P19_8 <- P19_8
# sum several columns in R
var_dep$P19_suma <- rowSums(var_dep[12:19], na.rm=TRUE)
unique(var_dep$P19_suma)
# #RECODING the values
P1_clean <- var_dep %>%
dplyr::select(P1_MAmb) %>%
rec(rec= "1=5;2=4;3=3;4=2;5=1;8,9=0;else=copy",suffix="")
P3F_clean <- var_dep %>%
dplyr::select(P3F) %>%
rec(rec= "1=5;2=4;3=3;4=2;5=1;8,9=0;else=copy",suffix="")
P30_clean <- var_dep %>%
dplyr::select(P30) %>%
rec(rec= "1=5;2=3;3=1;9=0;else=copy",suffix="")
#
P20_clean <- var_dep %>%
dplyr::select(P20) %>%
rec(rec= "4=1;3=5;2=3;1=4;8,9=0; else=copy",suffix="")
#
P4_clean <- var_dep %>%
dplyr::select(P4) %>%
rec(rec= "1=1;2=3;3=5;8,9=0;else=copy",suffix="")
var_dep$P20 <- P20_clean
var_dep$P4 <- P4_clean
var_dep$P3F <- P3F_clean
var_dep$P1_MAmb <- P1_clean
#after cleaning all the data, convert to numeric type
# var_dep[] <- lapply(var_dep, function(x) as.numeric(as.character(x)))
var_dep_total <- var_dep %>% dplyr::select(ZONAS,P1_MAmb, P2_COD, P3F, P4, P17_COD, P19_1,P19_2,P19_3,P19_4,P19_5,P19_6,P19_7,P19_8, P19_suma, P20, P21B, P21C, P21D, P21_promedio, P30)
var_dep_total %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P1_MAmb))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P1_Mamb" ,x = "Zonas de Chile", y = "P1_Mamb") +
theme_minimal(base_family = "Roboto Condensed")
#frq(df_lapop_chile, eff1)
length(which(var_dep_total$P17_COD==99))
var_dep_total %>%
ggplot(aes(x = as_factor(ZONAS), y = P17_COD)) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P17_COD" ,x = "Zonas de Chile", y = "P17_COD") +
theme_minimal(base_family = "Roboto Condensed")
#frq(df_lapop_chile, eff1)
var_dep_total <- var_dep_total[var_dep_total$P17_COD  != 99, ]
length(which(var_dep_total$P2_COD==99))
var_dep_total %>%
ggplot(aes(x = as_factor(ZONAS), y = P2_COD)) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P2_COD" ,x = "Zonas de Chile", y = "P2_COD") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_clean <- var_dep_total[var_dep_total$P2_COD  != 99, ]
length(which(var_dep_total_P2_clean$P20==1))
length(which(var_dep_total_P2_clean$P20==0))
var_dep_total_P2_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P20))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P20" ,x = "Zonas de Chile", y = "P20") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_clean <- var_dep_total_P2_clean[var_dep_total_P2_clean$P20  >0, ]
var_dep_total_P2_P20_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = P30)) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P30" ,x = "Zonas de Chile", y = "P30") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_clean <- var_dep_total_P2_P20_clean[var_dep_total_P2_P20_clean$P2_COD  <8, ]
length(which(var_dep_total_P2_P20_P30_clean$P4==0))
var_dep_total_P2_P20_P30_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P4))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P4" ,x = "Zonas de Chile", y = "P4") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_clean <- var_dep_total_P2_P20_P30_clean[var_dep_total_P2_P20_P30_clean$P4  >0, ]
length(which(var_dep_total_P2_P20_P30_clean$P3F==0))
var_dep_total_P2_P20_P30_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P3F))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P3F" ,x = "Zonas de Chile", y = "P3F") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_clean <- var_dep_total_P2_P20_P30_clean[var_dep_total_P2_P20_P30_clean$P3F  >0, ]
length(which(var_dep_total_P2_P20_P30_clean$P21_promedio==1))
length(which(var_dep_total_P2_P20_P30_clean$P21_promedio==0))
length(which(var_dep_total_P2_P20_P30_clean$P21_promedio==2))
var_dep_total_P2_P20_P30_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P21_promedio))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P21_Promedio" ,x = "Zonas de Chile", y = "P21_Promedio") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_P21promedio_clean <- var_dep_total_P2_P20_P30_clean[var_dep_total_P2_P20_P30_clean$P21_promedio>0, ]
var_dep_total_P2_P20_P30_P21promedio_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P19_1))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P19_1" ,x = "Zonas de Chile", y = "P19_1") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_P21promedio_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P19_2))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P19_2" ,x = "Zonas de Chile", y = "P19_2") +
theme_minimal(base_family = "Roboto Condensed")
length(which(var_dep_total_P2_P20_P30_P21promedio_clean$P19_3==5))
var_dep_total_P2_P20_P30_P21promedio_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P19_3))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P19_3" ,x = "Zonas de Chile", y = "P19_3") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_P21promedio_P19_3_clean <- var_dep_total_P2_P20_P30_P21promedio_clean %>% dplyr::select(ZONAS,P1_MAmb, P2_COD, P3F, P4, P17_COD, P19_1,P19_2,P19_4,P19_5,P19_6,P19_7,P19_8, P19_suma, P20, P21B, P21C, P21D, P21_promedio, P30)
length(which(var_dep_total_P2_P20_P30_P21promedio_P19_3_clean$P19_4==5))
var_dep_total_P2_P20_P30_P21promedio_P19_3_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P19_4))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P19_4" ,x = "Zonas de Chile", y = "P19_4") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_clean %>% dplyr::select(ZONAS,P1_MAmb, P2_COD, P3F, P4, P17_COD, P19_1,P19_2,P19_5,P19_6,P19_7,P19_8, P19_suma, P20, P21B, P21C, P21D, P21_promedio, P30)
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P19_5))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P19_5" ,x = "Zonas de Chile", y = "P19_5") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P19_6))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P19_6" ,x = "Zonas de Chile", y = "P19_6") +
theme_minimal(base_family = "Roboto Condensed")
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P21B))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P21B" ,x = "Zonas de Chile", y = "P21B") +
theme_minimal(base_family = "Roboto Condensed")
#frq(df_lapop_chile, eff1)
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean[var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean$P21B  > 0, ]
length(which(var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean$P21B==0))
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P21C))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P21C" ,x = "Zonas de Chile", y = "P21C") +
theme_minimal(base_family = "Roboto Condensed")
#frq(df_lapop_chile, eff1)
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean[var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean$P21C  > 0, ]
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean %>%
ggplot(aes(x = as_factor(ZONAS), y = unlist(P21D))) +
geom_jitter(shape = 16, position = position_jitter(0.2), color = "#588157") +
geom_boxplot(fill = "#a3b18a", color = "#3a5a40", alpha = 0.5) +
stat_summary(fun = mean) +
labs(title = "Boxplot de P21D" ,x = "Zonas de Chile", y = "P21D") +
theme_minimal(base_family = "Roboto Condensed")
#frq(df_lapop_chile, eff1)
var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean[var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean$P21C  > 0, ]
var_dep_total_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean
#with p21_promedio and not its 3 subquestions
var_dep_total_clean_reduced <- var_dep_total_clean %>% dplyr::select(ZONAS,P1_MAmb, P2_COD, P3F, P4, P17_COD, P19_1,P19_2,P19_5,P19_6,P19_7,P19_8, P19_suma, P20, P21_promedio, P30)
#seleccionamos los subsets
var_dep_P17_COD <- var_dep_total_clean %>% dplyr::select(P17_COD)
var_dep_P2_COD <- var_dep_total_clean %>% dplyr::select(P2_COD)
var_dep_importancia <- var_dep_total_clean %>% dplyr::select(ZONAS,P1_MAmb, P3F, P4, P20, P21B, P21C, P21D, P21_promedio, P30)
var_dep_preocupacion <- var_dep_total_clean %>% dplyr::select(ZONAS,P30, P19_1,P19_2,P19_3,P19_4,P19_5,P19_6,P19_7,P19_8, P19_suma, P20)
var_dep_total_clean[] <- lapply(var_dep_total_clean, function(x) as.numeric(as.character(x)))
#seleccionamos los subsets
var_dep_P17_COD <- var_dep_total_clean %>% dplyr::select(P17_COD)
var_dep_P2_COD <- var_dep_total_clean %>% dplyr::select(P2_COD)
var_dep_importancia <- var_dep_total_clean %>% dplyr::select(ZONAS,P1_MAmb, P3F, P4, P20, P21B, P21C, P21D, P21_promedio, P30)
var_dep_preocupacion <- var_dep_total_clean %>% dplyr::select(ZONAS,P30, P19_1,P19_2,P19_3,P19_4,P19_5,P19_6,P19_7,P19_8, P19_suma, P20)
var_dep_total_clean[] <- lapply(var_dep_total_clean, function(x) as.numeric(as.character(x)))
#seleccionamos los subsets
var_dep_P17_COD <- var_dep_total_clean %>% dplyr::select(P17_COD)
var_dep_P2_COD <- var_dep_total_clean %>% dplyr::select(P2_COD)
var_dep_importancia <- var_dep_total_clean %>% dplyr::select(ZONAS,P1_MAmb, P3F, P4, P20, P21B, P21C, P21D, P21_promedio, P30)
var_dep_preocupacion <- var_dep_total_clean %>% dplyr::select(ZONAS,P30, P19_1,P19_2,P19_5,P19_6,P19_7,P19_8, P19_suma, P20)
#saving dataframes to .sav format
write_sav(var_dep_P17_COD, "var_dependientes_P17_clean.sav")
write_sav(var_dep_P2_COD, "var_dependientes_P2_clean.sav")
var_dep_importancia <- do.call(data.frame, var_dep_importancia)
var_dep_preocupacion <- do.call(data.frame, var_dep_preocupacion)
var_dep_total <- do.call(data.frame, var_dep_total)
write_sav(var_dep_importancia, "var_dependientes_importancia_clean.sav")
write_sav(var_dep_preocupacion, "var_dependientes_preocupacion_clean.sav")
write_sav(var_dep_total, "var_dependientes_total_clean.sav")
var_dep_total_clean <- do.call(data.frame, var_dep_total_clean)
var_dep_total_clean_reduced <- do.call(data.frame, var_dep_total_clean_reduced)
str(var_dep_total_clean)
var_dep_total_clean <- var_dep_total_P2_P20_P30_P21promedio_P19_3_4_clean
#with p21_promedio and not its 3 subquestions
var_dep_total_clean_reduced <- var_dep_total_clean %>% dplyr::select(ZONAS,P1_MAmb, P2_COD, P3F, P4, P17_COD, P19_1,P19_2,P19_5,P19_6,P19_7,P19_8, P19_suma, P20, P21_promedio, P30)
write_sav(var_dep_total_clean_reduced, "var_dependientes_total_clean_reduced_final.sav")
var_dep_total_clean <- do.call(data.frame, var_dep_total_clean)
var_dep_total_clean_reduced <- do.call(data.frame, var_dep_total_clean_reduced)
write_sav(var_dep_total_clean_reduced, "var_dependientes_total_clean_reduced_final.sav")
write_sav(var_dep_total_clean, "var_dependientes_total_clean_unreduced_final.sav")
var_dep_total_clean_reduced[] <- lapply(var_dep_total_clean_reduced, function(x) {
if(is.factor(x)) as.numeric(as.character(x)) else x
})
cor(na.omit(var_dep_total_clean_reduced)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_total_clean_reduced, label = T) #NA se omiten automáticamente
var_dep_total_clean_remove <- names(var_dep_total_clean_reduced) %in% c("ZONAS","P30", "P19_suma", "P21_promedio", "P4", "P20", "P17_COD")
var_dep_high_corr  <- var_dep_total_clean_reduced[!var_dep_total_clean_remove]
cor(na.omit(var_dep_high_corr)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_high_corr, label = T) #NA se omiten automáticamente
var_dep_total_clean_remove <- names(var_dep_total_clean_reduced) %in% c("ZONAS","P30", "P19_suma", "P21_promedio", "P4", "P20", "P17_COD")
var_dep_high_corr  <- var_dep_total_clean_reduced[!var_dep_total_clean_remove]
# cor(na.omit(var_dep_high_corr)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_high_corr, label = T) #NA se omiten automáticamente
library(ggcorrplot)
var_dep_total_clean_remove <- names(var_dep_total_clean_reduced) %in% c("ZONAS","P30", "P19_suma", "P21_promedio", "P4", "P20", "P17_COD")
var_dep_high_corr  <- var_dep_total_clean_reduced[!var_dep_total_clean_remove]
# cor(na.omit(var_dep_high_corr)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_high_corr, label = T) #NA se omiten automáticamente
library(ggcorrplot)
var_dep_total_clean_remove <- names(var_dep_total_clean_reduced) %in% c("ZONAS","P30", "P19_suma", "P21_promedio", "P4", "P20", "P17_COD")
var_dep_high_corr  <- var_dep_total_clean_reduced[!var_dep_total_clean_remove]
# cor(na.omit(var_dep_high_corr)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_high_corr, label = T) #NA se omiten automáticamente
library(ggcorrplot)
var_dep_total_clean_remove <- names(var_dep_total_clean_reduced) %in% c("ZONAS","P30", "P19_suma", "P21_promedio", "P4", "P20", "P17_COD")
var_dep_high_corr  <- var_dep_total_clean_reduced[!var_dep_total_clean_remove]
# cor(na.omit(var_dep_high_corr)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_high_corr, label = T) #NA se omiten automáticamente
library(ggcorrplot)
var_dep_total_clean_remove <- names(var_dep_total_clean_reduced) %in% c("ZONAS","P30", "P19_suma", "P21_promedio", "P4", "P20", "P17_COD")
var_dep_high_corr  <- var_dep_total_clean_reduced[!var_dep_total_clean_remove]
# cor(na.omit(var_dep_high_corr)) #Correlaciones: es necesario omitir los NA.
ggcorr(var_dep_high_corr, label = T) #NA se omiten automáticamente
